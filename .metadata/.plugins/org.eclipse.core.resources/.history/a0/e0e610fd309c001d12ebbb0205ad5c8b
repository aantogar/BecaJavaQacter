package ejerciciosBanco;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

public  class Cuenta {
	private String titular;
	private String numero;
	private  List<Movimiento> movimientos=new ArrayList<Movimiento>();
	
	
	
	public Cuenta(String numero,String titular) {
		this.titular=titular;
		this.numero=numero;
		
	}
	public Cuenta() {
		
	}

	public  double getSaldo()  {
		double r=0.0;
				for(Movimiento m: movimientos) {
					r+=m.getMiimporte();
				}
				return r;		
	}
	public void setSaldo(double x) {
		Movimiento mov = new Movimiento();
		mov.setConcepto("Añadido saldo");
		mov.setMiimporte(x);
		movimientos.add(mov);
	}

	public void ingresar(double x)throws Exception {
		if(x<=0)
			throw new Exception("No se ha podido ingresar la cantidad.");
		ingresar("Ingreso en efectivo: ",x);
	    }
		
	
	public void ingresar(String concepto, double x) throws Exception {
		Movimiento mov=new Movimiento();
		List<Movimiento>set=getMovimientos();
		if(x<=0)
			throw new Exception("No se ha podido ingresar la cantidad.");
		mov.setConcepto(concepto);
		mov.setMiimporte(x);
		set.add(mov);
		setMovimientos(set);
	}
	public void retirar(double x) throws Exception  {  
		if(x>0 || getSaldo()>x)
		throw new Exception("No se ha podido ingresar la cantidad.");
		retirar("Retirada de efectivo",x);
    		
	}
	public void retirar(String concepto, double x) throws Exception {
		Movimiento mov=new Movimiento();
		List<Movimiento>set=getMovimientos();
		//metemos en un bloque try catch la operación por si no hay saldo.
		try {
			if(x>0 || getSaldo()>x) {
			mov.setConcepto(concepto);
			set.add(mov);
			setMovimientos(set);
			}
		}catch(Exception e) {
			throw new Exception("No hay saldo suficiente en la cuenta para realizar la operación");
		}
	}
	

	public String getTitular() {
		return titular;
	}

	public void setTitular(String titular) {
		this.titular = titular;
	}

	public String getNumero() {
		return numero;
	}

	public void setNumero(String numero) {
		this.numero = numero;
	}
	public List<Movimiento> getMovimientos() {
		return movimientos;
	}
	public void setMovimientos(List<Movimiento> movimientos) {
		//Creo un nuevo HashSet identico al que se recibe para evitar lios con el
		// pointer.
		this.movimientos = new ArrayList<Movimiento>(movimientos);
	}
	public void mostrarMovimientos()  {
		
		for (int i=0;i<movimientos.size();i++) {
			System.out.println(movimientos.get(i).getMovimientos());
		}

	}

	@Override
	public String toString() {
		return "Cuenta del titular: " + getTitular() + ", nº de cuenta" + numero + "\nSaldo: "+ getSaldo()+
				".Ha realizado los siguientes movimientos: "+getMovimientos();
	}

	public void setMovimientos(List<Movimiento> movimientos,Movimiento m) {
		this.movimientos=movimientos;
	
		
	} 
	protected void addMovimiento(Movimiento m) {
		List<Movimiento>mov=getMovimientos();
		mov.add(m);
		setMovimientos(mov);
		
	}

}
